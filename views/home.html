<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<body>

	<!-- Libraries -->
	<script type="text/javascript" src="libs/jq.js"></script>
	<script type="text/javascript" src="libs/underscore.js"></script>
	<script type="text/javascript" src="libs/moment.js"></script>
	<link rel="Stylesheet" type="text/css" href="libs/hint.css" />


	<!-- MVC -->
	<script type="text/javascript" src="libs/backbone.js"></script>
	<script type="text/javascript" src="libs/xo.js"></script>

	<!-- Style -->
	<link rel="Stylesheet" type="text/css" href="style/reset.css" />
	<link rel="Stylesheet" type="text/css" href="style/presto.css" />
	<link rel="Stylesheet" type="text/css" href="style/home.css" />

	<script type="text/javascript" src="../js/CalculatorBlueprintModel.js"></script>

	<link href='libs/lato/lato.css' rel='stylesheet' type='text/css'>
	<link href='libs/font-awesome/css/font-awesome.css' rel='stylesheet' type='text/css'>

	<script>



		$(document).ready(function(){

			Presto = new Presto_Block_Home();

		});





	Presto_Block_Home = XO.Block.extend({
		block : 'home',

		render : function()
		{
			var self = this;


			this.calculatorCollection = new XO.Collection([],{
				url : '/api/calculator',
				model:Presto_Model_CalculatorBlueprint
			});

			this.calculatorCollection.on('add', function(calc) {
				self.addCalculator(calc);
			});


			this.dom.newCalculatorButton.click(function(){
				self.calculatorCollection.addNew();
			});

			this.calculatorCollection.fetch();
			return this;
		},

		addCalculator : function(calculatorModel)
		{
			var newBlock = new Presto_Block_CalculatorOption(calculatorModel);
			newBlock.injectInto(this.dom.container, {at_top:true});
			return this;
		},


	})




	Presto_Block_CalculatorOption = XO.Block.extend({
		schematic : 'calculator',

		render : function()
		{
			var self = this;

			this.model.onChange('color', function(){
				self.dom.block.addClass(self.model.get('color'));
			});
			this.model.onChange('title', function(){
				self.dom.title.text(self.model.get('title'));
			});
			this.model.onChange('description', function(){
				self.dom.description.text(self.model.get('description'));
			});
			this.model.onChange('icon', function(){
				self.dom.icon.find('i').addClass(self.model.get('icon'));
			});
			this.model.onChange('url', function(){
				self.dom.link.attr('href', self.model.get('url'));
			});

			this.dom.deleteBtn.click(function(event){
				event.preventDefault();
				var temp = confirm("Are you sure you want to delete this calculator?");
				if(temp){
					self.model.destroy();
					self.remove();
				}
			});

			return this;
		},


	});


	</script>



	<div class='sidebar'>
		<img class='sidebar__logo' src='assets/rabbit hat.png'></img>
		<div class='sidebar__text'>Presto</div>

	</div>


	<div class='content' xo-block='home'>
		<!--
		<div class='content__title'>Presto Calculators</div>

		<div class='content__search'>
			<i class='icon-search'></i>
			<input type='text'></input>

		</div>

		<div class='content__groups'>
			<div class='content__groupsContainer' style='max-width:700px;'>

				<div class='button green disabled'><i class='icon-gear'></i> Edit</div>
				<div class='button blue'><i class='icon-cut'></i> Stuff</div>
				<div class='button orange'><i class='icon-link'></i> Taxes</div>
				<div class='button green'><i class='icon-gear'></i> How does this look with longer text</div>
				<div class='button blue'><i class='icon-cut'></i> Pretty cool</div>
				<div class='button orange'><i class='icon-link'></i> I concur</div>
				<div class='button green'><i class='icon-gear'></i> Edit</div>
				<div class='button blue'><i class='icon-cut'></i> Stuff</div>
				<div class='button orange'><i class='icon-link'></i> Taxes</div>

			</div>
		</div>


<div class='groupContainer' xo-element='groupContainer'>

	<div class='group'>
		<div class='group__title'><i class='icon-plane'></i> <span class='group__text'>Flight</span> </div>
		<div class='calcContainer'>
		</div>
	</div>
</div>

	-->

		<div class='calculator newCalculator yellow' xo-element='newCalculatorButton'>
			<div class='calculator__icon' xo-element='icon'><i class='icon-plus'></i></div>
			<div class='calculator__info'>
				<div class='calculator__info__title' xo-element='title'>Create Calculator</div>
				<div class='calculator__info__description' xo-element='description'>Click here to create a new calculator</div>
			</div>
		</div>

		<div class='calculatorContainer' xo-element='container'>
			<!-- Calculators go here! -->
		</div>
	</div>


	<!-- Schematics -->
	<div class='calculator' xo-schematic='calculator'>
		<a xo-element='link' target="_blank">
			<div class='calculator__icon' xo-element='icon'><i></i></div>
			<div class='calculator__info'>
				<div class='calculator__info__title' xo-element='title'></div>
				<div class='calculator__info__description' xo-element='description'></div>
			</div>
			<div class='calculator__delete' xo-element='deleteBtn'>
				<i class='icon-remove'></i>
			</div>
		</a>
	</div>


</body>
</html>