<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>

	<!-- Libraries -->
	<script type="text/javascript" src="libs/jq.js"></script>
	<script type="text/javascript" src="libs/underscore.js"></script>

	<!-- MVC -->
	<script type="text/javascript" src="libs/backbone.js"></script>
	<script type="text/javascript" src="libs/archetype.js"></script>
	<script type="text/javascript" src="libs/xo.js"></script>

	<!-- Style -->
	<link rel="Stylesheet" type="text/css" href="style/reset.css" />
	<link rel="Stylesheet" type="text/css" href="style/presto.css" />
	<link rel="Stylesheet" type="text/css" href="style/admin.css" />

	<link href='libs/lato/lato.css' rel='stylesheet' type='text/css'>
	<link href='libs/font-awesome/css/font-awesome.css' rel='stylesheet' type='text/css'>

</head>



<body xo-view='admin'>

	<title>Presto Admin</title>

	<script>
		var endpoints = <%- inspect(routes) %>;


		var endpointView = xo.view.extend({
			schematic : 'endpoint',

			render : function()
			{
				var self = this;
				this.dom.url.text(this.model.model.urlRoot);

				this.model.on('add', function(){
					self.dom.count.text(self.model.length);
				});

				return this;
			},
		});


		$(document).ready(function(){

			data = _.map(endpoints, function(ep){
				console.log(ep);

				var col = xo.collection.extend({
					model : xo.model.extend({
						urlRoot : ep
					})
				});


				var view = endpointView.create();
				view.model = col;
				view.injectInto($('body'));


				col.fetch();

				return col;
			});

		});




	</script>

	<div class='sidebar'>


	</div>


	<div class='content'>

		ADMIN!

	</div>


	<div xo-schematic='endpoint'>
		<span xo-element='url'></span>
		<span xo-element='count'></span>
	</div>

</body>
</html>
